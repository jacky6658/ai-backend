# AI çŸ­å½±éŸ³é¡§å•æ™ºèƒ½ç³»çµ± - å¾Œç«¯

## ğŸš€ ç³»çµ±æ¦‚è¿°

é€™æ˜¯ä¸€å€‹åŸºæ–¼ FastAPI çš„ AI çŸ­å½±éŸ³é¡§å•æ™ºèƒ½ç³»çµ±å¾Œç«¯ï¼Œæä¾›ä¸‰ç¨®æ ¸å¿ƒ AI åŠŸèƒ½ï¼š
- ğŸ¯ AI çŸ­å½±éŸ³å®šä½é¡§å•
- ğŸ’¡ AI é¸é¡Œå°åŠ©æ‰‹  
- ğŸ“ AI è…³æœ¬ç”Ÿæˆå¤§å¸«

## ğŸ“Š ç•¶å‰ç³»çµ±ç‹€æ…‹ (2024-10-20)

### âœ… å·²å®ŒæˆåŠŸèƒ½
- **ç”¨æˆ¶èªè­‰ç³»çµ±**ï¼šEmail è¨»å†Š/ç™»å…¥ + Google OAuth
- **æ¨è–¦ç¢¼ç³»çµ±**ï¼šé‚€è«‹æœ‹å‹è¨»å†Šï¼Œé›™æ–¹å„å¾— 500 é»æ•¸
- **é»æ•¸ç®¡ç†**ï¼šæ–°ç”¨æˆ¶ 500 é»ï¼Œæ¨è–¦çå‹µ 500 é»ï¼Œä½¿ç”¨æ‰£é»
- **SSE ä¸²æµ**ï¼šå³æ™‚é€å­—è¼¸å‡ºï¼Œæä¾› GPT èˆ¬é«”é©—
- **RAG æ•´åˆ**ï¼šçµåˆçŸ¥è­˜åº«é€²è¡Œæ™ºèƒ½å›ç­”
- **å¾Œå°ç®¡ç†**ï¼šç”¨æˆ¶ç®¡ç†ã€é»æ•¸å……å€¼ã€æ¨è–¦ç¢¼ç®¡ç†
- **è³‡æ–™åº«ä¿®å¾©**ï¼šè‡ªå‹•ä¿®å¾©ç¼ºå¤±æ¬„ä½ï¼Œç¢ºä¿æ•¸æ“šå®Œæ•´æ€§

### ğŸ”§ æŠ€è¡“æ¶æ§‹ç‹€æ…‹
- **FastAPI æœå‹™**ï¼šé‹è¡Œåœ¨ç«¯å£ 8080
- **SQLite è³‡æ–™åº«**ï¼šåŒ…å« users, users_auth, credit_transactions ç­‰è¡¨
- **CORS é…ç½®**ï¼šæ”¯æ´è·¨åŸŸè«‹æ±‚
- **éŒ¯èª¤è™•ç†**ï¼šå®Œæ•´çš„ç•°å¸¸è™•ç†å’Œæ—¥èªŒè¨˜éŒ„

## âœ¨ ä¸»è¦åŠŸèƒ½

### ç”¨æˆ¶ç®¡ç†
- **è¨»å†Š/ç™»å…¥ç³»çµ±**ï¼šæ”¯æŒ Email è¨»å†Šå’Œ Google OAuth ç™»å…¥
- **æ¨è–¦ç¢¼ç³»çµ±**ï¼šé‚€è«‹æœ‹å‹è¨»å†Šï¼Œé›™æ–¹å„å¾— 500 é»æ•¸
- **é»æ•¸ç®¡ç†**ï¼šæ–°ç”¨æˆ¶è¨»å†Šç²å¾— 500 é»æ•¸ï¼Œä½¿ç”¨æ¨è–¦ç¢¼é¡å¤–ç²å¾— 500 é»æ•¸
- **ç”¨æˆ¶æª”æ¡ˆ**ï¼šå€‹äººè³‡æ–™ç®¡ç†å’Œä½¿ç”¨çµ±è¨ˆ
- **æœƒè©±ç®¡ç†**ï¼šå®‰å…¨çš„ Cookie æœƒè©±å’Œç™»å‡ºåŠŸèƒ½

### AI åŠŸèƒ½
- **å®šä½é¡§å•**ï¼šåŸºæ–¼çŸ¥è­˜åº«çš„çŸ­å½±éŸ³å®šä½åˆ†æ
- **é¸é¡ŒåŠ©æ‰‹**ï¼šæ™ºèƒ½é¸é¡Œå»ºè­°å’Œå…§å®¹è¦åŠƒ
- **è…³æœ¬ç”Ÿæˆ**ï¼šæ”¯æŒå¤šç¨®æ¨¡æ¿ï¼ˆA-Eï¼‰å’Œå¹³å°ï¼ˆReels/TikTok/å°ç´…æ›¸/YouTube Shortsï¼‰
- **SSE ä¸²æµ**ï¼šå³æ™‚é€å­—è¼¸å‡ºï¼Œæä¾› GPT èˆ¬çš„é«”é©—
- **RAG æ•´åˆ**ï¼šçµåˆçŸ¥è­˜åº«é€²è¡Œæ™ºèƒ½å›ç­”

### ç®¡ç†ç³»çµ±
- **å¾Œå°ç®¡ç†**ï¼šç”¨æˆ¶ç®¡ç†ã€é»æ•¸ç®¡ç†ã€æ¨è–¦ç¢¼ç®¡ç†
- **æ•¸æ“šåˆ†æ**ï¼šä½¿ç”¨çµ±è¨ˆå’Œç³»çµ±ç›£æ§
- **é»æ•¸äº¤æ˜“è¨˜éŒ„**ï¼šå®Œæ•´çš„é»æ•¸è®Šå‹•æ­·å²
- **ç®¡ç†å“¡èªè­‰**ï¼šå®‰å…¨çš„å¾Œå°ç™»å…¥ç³»çµ±
- **è‡ªå‹•ä¿®å¾©**ï¼šè³‡æ–™åº«çµæ§‹è‡ªå‹•æª¢æ¸¬å’Œä¿®å¾©

## ğŸ›  æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æŠ€è¡“æ£§
- **FastAPI**ï¼šç¾ä»£åŒ–çš„ Python Web æ¡†æ¶
- **SQLite**ï¼šè¼•é‡ç´šè³‡æ–™åº«
- **Uvicorn**ï¼šASGI æœå‹™å™¨
- **Authlib**ï¼šOAuth èªè­‰
- **Pydantic**ï¼šæ•¸æ“šé©—è­‰

### æ ¸å¿ƒæ¨¡çµ„
```
backend/
â”œâ”€â”€ app.py                 # ä¸»æ‡‰ç”¨ç¨‹å¼
â”œâ”€â”€ chat_stream.py         # SSE ä¸²æµèŠå¤©
â”œâ”€â”€ memory.py             # ç”¨æˆ¶è¨˜æ†¶ç®¡ç†
â”œâ”€â”€ rag.py                # æª¢ç´¢å¢å¼·ç”Ÿæˆ
â”œâ”€â”€ knowledge_loader.py   # çŸ¥è­˜åº«è¼‰å…¥
â”œâ”€â”€ providers.py          # LLM æä¾›å•†ä»‹é¢
â”œâ”€â”€ admin/
â”‚   â””â”€â”€ admin.html        # å¾Œå°ç®¡ç†ä»‹é¢
â””â”€â”€ data/
    â”œâ”€â”€ kb_positioning.txt
    â”œâ”€â”€ kb_topic_selection.txt
    â””â”€â”€ kb_script_generation.txt
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚
- Python 3.11+
- pip æˆ– conda

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†å°ˆæ¡ˆ**
```bash
git clone <repository-url>
cd ai_web_app/å°è©±å¼/åŸå§‹/backend
```

2. **å‰µå»ºè™›æ“¬ç’°å¢ƒ**
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate     # Windows
```

3. **å®‰è£ä¾è³´**
```bash
pip install -r requirements.txt
```

4. **è¨­ç½®ç’°å¢ƒè®Šæ•¸**
```bash
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
cp .env.example .env

# ç·¨è¼¯ .env æ–‡ä»¶
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
OAUTH_REDIRECT_URI=https://your-domain.com/auth/google/callback
ADMIN_TOKEN=your_admin_token
```

5. **åˆå§‹åŒ–è³‡æ–™åº«**
```bash
python -c "from app import init_db; init_db()"
```

6. **å•Ÿå‹•æœå‹™**
```bash
python app.py
```

æœå‹™å°‡åœ¨ `http://localhost:8080` å•Ÿå‹•

## ğŸ“š API æ–‡æª”

### èªè­‰ç›¸é—œ
- `POST /auth/signup` - ç”¨æˆ¶è¨»å†Š
- `POST /auth/login` - ç”¨æˆ¶ç™»å…¥
- `POST /auth/logout` - ç”¨æˆ¶ç™»å‡º
- `GET /me` - ç²å–ç•¶å‰ç”¨æˆ¶è³‡è¨Š
- `GET /auth/google/start` - Google OAuth é–‹å§‹
- `GET /auth/google/callback` - Google OAuth å›èª¿
- `GET /auth/google/success` - Google ç™»å…¥æˆåŠŸé é¢

### AI åŠŸèƒ½
- `POST /api/chat` - éä¸²æµèŠå¤©
- `GET /api/stream` - SSE ä¸²æµèŠå¤©
- `POST /api/positioning` - å®šä½åˆ†æ
- `POST /api/topics` - é¸é¡Œå»ºè­°
- `POST /api/script` - è…³æœ¬ç”Ÿæˆ

### ç”¨æˆ¶ç®¡ç†
- `GET /api/user/profile` - ç”¨æˆ¶æª”æ¡ˆ
- `GET /api/user/knowledge` - çŸ¥è­˜åº«å…§å®¹
- `POST /api/user/profile` - æ›´æ–°ç”¨æˆ¶æª”æ¡ˆ

### ç®¡ç†å¾Œå°
- `GET /admin/users` - ç”¨æˆ¶åˆ—è¡¨
- `POST /admin/charge` - å……å€¼é»æ•¸
- `GET /admin/referrals` - æ¨è–¦ç¢¼ç®¡ç†

## ğŸ”§ é…ç½®èªªæ˜

### ç’°å¢ƒè®Šæ•¸
```bash
# Google OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
OAUTH_REDIRECT_URI=https://your-domain.com/auth/google/callback

# ç®¡ç†å“¡
ADMIN_TOKEN=your_secret_admin_token

# è³‡æ–™åº«
DB_PATH=three_agents_system.db

# CORS
ALLOWED_ORIGINS=https://your-frontend-domain.com,http://localhost:3000
```

### è³‡æ–™åº«çµæ§‹
- **users**ï¼šç”¨æˆ¶åŸºæœ¬è³‡è¨Š
- **users_auth**ï¼šèªè­‰è³‡è¨Š
- **user_profiles**ï¼šç”¨æˆ¶æª”æ¡ˆ
- **messages**ï¼šèŠå¤©è¨˜éŒ„
- **summaries**ï¼šå°è©±æ‘˜è¦
- **credit_transactions**ï¼šé»æ•¸äº¤æ˜“è¨˜éŒ„

## ğŸš€ éƒ¨ç½²

### Docker éƒ¨ç½²
```bash
# æ§‹å»ºæ˜ åƒ
docker build -t ai-video-backend .

# é‹è¡Œå®¹å™¨
docker run -p 8080:8080 \
  -e GOOGLE_CLIENT_ID=your_id \
  -e GOOGLE_CLIENT_SECRET=your_secret \
  -e ADMIN_TOKEN=your_token \
  ai-video-backend
```

### é›²ç«¯éƒ¨ç½²
æ”¯æ´éƒ¨ç½²åˆ°ï¼š
- **Zeabur**ï¼šæ¨è–¦ä½¿ç”¨
- **Railway**
- **Heroku**
- **AWS/GCP/Azure**

## ğŸ” ç›£æ§èˆ‡æ—¥èªŒ

### å¥åº·æª¢æŸ¥
```bash
curl http://localhost:8080/healthz
```

### æ—¥èªŒæŸ¥çœ‹
```bash
# æŸ¥çœ‹æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ
tail -f logs/app.log

# æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
tail -f logs/error.log
```

## ğŸ›  é–‹ç™¼æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `app.py` ä¸­æ·»åŠ è·¯ç”±
2. å¯¦ç¾å°æ‡‰çš„æ¥­å‹™é‚è¼¯
3. æ›´æ–° API æ–‡æª”
4. æ·»åŠ æ¸¬è©¦ç”¨ä¾‹

### è³‡æ–™åº«é·ç§»
```bash
# å‰µå»ºé·ç§»è…³æœ¬
python scripts/migrate.py

# åŸ·è¡Œé·ç§»
python scripts/migrate.py --up
```

## ğŸ“ æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹è¯ç¹«ï¼š
- æŠ€è¡“æ”¯æ´ï¼šsupport@example.com
- æ–‡æª”ï¼šhttps://docs.example.com
- GitHub Issuesï¼šhttps://github.com/your-repo/issues

## ğŸ“„ æˆæ¬Š

MIT License - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶